<!DOCTYPE html>
<html>
<head>
  <title>Upload to Google Drive</title>
</head>
<body>
  <h2>File Upload Test</h2>
  <form id="form">
    <input name="file" id="uploadfile" type="file" />
    <input id="submit" type="submit" />
  </form>

  <script>
    const form = document.getElementById("form");
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const file = form.file.files[0];
      const fr = new FileReader();
      fr.readAsArrayBuffer(file);
      fr.onload = (f) => {
        const url = "https://script.google.com/macros/s/AKfycbw4sfoVLa_OTg1FQn-jc0JJV5vlrJQtv3bOGpiZxbEM4ouCaXL4Vn5_3xKeLKiwSqwX/exec"; // Please set the URL of Web Apps.

        const qs = new URLSearchParams({
          filename: file.name,
          mimeType: file.type,
        });
        fetch(`${url}?${qs}`, {
          method: "POST",
          body: JSON.stringify([...new Int8Array(f.target.result)]),
        })
          .then((res) => res.json())
          .then(console.log)
          .catch(console.log);
      };
    });
  </script>
</body>
</html>
